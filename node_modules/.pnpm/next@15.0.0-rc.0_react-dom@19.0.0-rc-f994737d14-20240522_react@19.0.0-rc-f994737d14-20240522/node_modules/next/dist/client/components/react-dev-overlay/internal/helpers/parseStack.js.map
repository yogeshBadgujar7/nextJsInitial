{"version":3,"sources":["../../../../../../src/client/components/react-dev-overlay/internal/helpers/parseStack.ts"],"sourcesContent":["import { parse } from 'next/dist/compiled/stacktrace-parser'\nimport type { StackFrame } from 'next/dist/compiled/stacktrace-parser'\nimport {\n  getHydrationErrorStackInfo,\n  isReactHydrationErrorStack,\n} from '../../../is-hydration-error'\n\nconst regexNextStatic = /\\/_next(\\/static\\/.+)/\n\nexport function parseStack(stack: string): StackFrame[] {\n  const messageAndStack = stack.replace(/^Error: /, '')\n  if (isReactHydrationErrorStack(messageAndStack)) {\n    const { stack: parsedStack } = getHydrationErrorStackInfo(messageAndStack)\n    if (parsedStack) {\n      stack = parsedStack\n    }\n  }\n\n  const frames = parse(stack)\n  return frames.map((frame) => {\n    try {\n      const url = new URL(frame.file!)\n      const res = regexNextStatic.exec(url.pathname)\n      if (res) {\n        const distDir = process.env.__NEXT_DIST_DIR\n          ?.replace(/\\\\/g, '/')\n          ?.replace(/\\/$/, '')\n        if (distDir) {\n          frame.file = 'file://' + distDir.concat(res.pop()!) + url.search\n        }\n      }\n    } catch {}\n    return frame\n  })\n}\n"],"names":["parseStack","regexNextStatic","stack","messageAndStack","replace","isReactHydrationErrorStack","parsedStack","getHydrationErrorStackInfo","frames","parse","map","frame","url","URL","file","res","exec","pathname","process","distDir","env","__NEXT_DIST_DIR","concat","pop","search"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":";;;;+BASgBA;;;eAAAA;;;kCATM;kCAKf;AAEP,MAAMC,kBAAkB;AAEjB,SAASD,WAAWE,KAAa;IACtC,MAAMC,kBAAkBD,MAAME,OAAO,CAAC,YAAY;IAClD,IAAIC,IAAAA,4CAA0B,EAACF,kBAAkB;QAC/C,MAAM,EAAED,OAAOI,WAAW,EAAE,GAAGC,IAAAA,4CAA0B,EAACJ;QAC1D,IAAIG,aAAa;YACfJ,QAAQI;QACV;IACF;IAEA,MAAME,SAASC,IAAAA,uBAAK,EAACP;IACrB,OAAOM,OAAOE,GAAG,CAAC,CAACC;QACjB,IAAI;YACF,MAAMC,MAAM,IAAIC,IAAIF,MAAMG,IAAI;YAC9B,MAAMC,MAAMd,gBAAgBe,IAAI,CAACJ,IAAIK,QAAQ;YAC7C,IAAIF,KAAK;oBACSG,sCAAAA;gBAAhB,MAAMC,WAAUD,+BAAAA,QAAQE,GAAG,CAACC,eAAe,sBAA3BH,uCAAAA,6BACZd,OAAO,CAAC,OAAO,yBADHc,qCAEZd,OAAO,CAAC,OAAO;gBACnB,IAAIe,SAAS;oBACXR,MAAMG,IAAI,GAAG,YAAYK,QAAQG,MAAM,CAACP,IAAIQ,GAAG,MAAOX,IAAIY,MAAM;gBAClE;YACF;QACF,EAAE,UAAM,CAAC;QACT,OAAOb;IACT;AACF"}