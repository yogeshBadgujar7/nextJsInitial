{"version":3,"sources":["../../../src/server/lib/incremental-cache-server.ts"],"sourcesContent":["import { createIpcServer } from './server-ipc'\nimport { IncrementalCache } from './incremental-cache'\n\nlet initializeResult:\n  | undefined\n  | {\n      ipcPort: number\n      ipcValidationKey: string\n    }\n\nexport async function initialize(\n  ...constructorArgs: ConstructorParameters<typeof IncrementalCache>\n): Promise<NonNullable<typeof initializeResult>> {\n  const incrementalCache = new IncrementalCache(...constructorArgs)\n\n  const { ipcPort, ipcValidationKey } = await createIpcServer({\n    async revalidateTag(\n      ...args: Parameters<IncrementalCache['revalidateTag']>\n    ) {\n      return incrementalCache.revalidateTag(...args)\n    },\n\n    async get(...args: Parameters<IncrementalCache['get']>) {\n      return incrementalCache.get(...args)\n    },\n\n    async set(...args: Parameters<IncrementalCache['set']>) {\n      return incrementalCache.set(...args)\n    },\n\n    async lock(...args: Parameters<IncrementalCache['lock']>) {\n      return incrementalCache.lock(...args)\n    },\n\n    async unlock(...args: Parameters<IncrementalCache['unlock']>) {\n      return incrementalCache.unlock(...args)\n    },\n  } as any)\n\n  return {\n    ipcPort,\n    ipcValidationKey,\n  }\n}\n"],"names":["initialize","initializeResult","constructorArgs","incrementalCache","IncrementalCache","ipcPort","ipcValidationKey","createIpcServer","revalidateTag","args","get","set","lock","unlock"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":";;;;+BAUsBA;;;eAAAA;;;2BAVU;kCACC;AAEjC,IAAIC;AAOG,eAAeD,WACpB,GAAGE,eAA+D;IAElE,MAAMC,mBAAmB,IAAIC,kCAAgB,IAAIF;IAEjD,MAAM,EAAEG,OAAO,EAAEC,gBAAgB,EAAE,GAAG,MAAMC,IAAAA,0BAAe,EAAC;QAC1D,MAAMC,eACJ,GAAGC,IAAmD;YAEtD,OAAON,iBAAiBK,aAAa,IAAIC;QAC3C;QAEA,MAAMC,KAAI,GAAGD,IAAyC;YACpD,OAAON,iBAAiBO,GAAG,IAAID;QACjC;QAEA,MAAME,KAAI,GAAGF,IAAyC;YACpD,OAAON,iBAAiBQ,GAAG,IAAIF;QACjC;QAEA,MAAMG,MAAK,GAAGH,IAA0C;YACtD,OAAON,iBAAiBS,IAAI,IAAIH;QAClC;QAEA,MAAMI,QAAO,GAAGJ,IAA4C;YAC1D,OAAON,iBAAiBU,MAAM,IAAIJ;QACpC;IACF;IAEA,OAAO;QACLJ;QACAC;IACF;AACF"}