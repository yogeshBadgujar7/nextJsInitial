{"version":3,"sources":["../../../src/build/webpack-config-rules/resolve.ts"],"sourcesContent":["import {\n  COMPILER_NAMES,\n  type CompilerNameValues,\n} from '../../shared/lib/constants'\n\n// exports.<conditionName>\nexport const edgeConditionNames = [\n  'edge-light',\n  'worker',\n  // inherits the default conditions\n  '...',\n]\n\nconst mainFieldsPerCompiler: Record<\n  CompilerNameValues | 'server-esm',\n  string[]\n> = {\n  // For default case, prefer CJS over ESM on server side. e.g. pages dir SSR\n  [COMPILER_NAMES.server]: ['main', 'module'],\n  [COMPILER_NAMES.client]: ['browser', 'module', 'main'],\n  [COMPILER_NAMES.edgeServer]: edgeConditionNames,\n  // For bundling-all strategy, prefer ESM over CJS\n  'server-esm': ['module', 'main'],\n}\n\nexport function getMainField(\n  compilerType: CompilerNameValues,\n  preferEsm: boolean\n) {\n  if (compilerType === COMPILER_NAMES.edgeServer) {\n    return edgeConditionNames\n  } else if (compilerType === COMPILER_NAMES.client) {\n    return mainFieldsPerCompiler[COMPILER_NAMES.client]\n  }\n\n  // Prefer module fields over main fields for isomorphic packages on server layer\n  return preferEsm\n    ? mainFieldsPerCompiler['server-esm']\n    : mainFieldsPerCompiler[COMPILER_NAMES.server]\n}\n"],"names":["edgeConditionNames","getMainField","mainFieldsPerCompiler","COMPILER_NAMES","server","client","edgeServer","compilerType","preferEsm"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":";;;;;;;;;;;;;;;IAMaA,kBAAkB;eAAlBA;;IAmBGC,YAAY;eAAZA;;;2BAtBT;AAGA,MAAMD,qBAAqB;IAChC;IACA;IACA,kCAAkC;IAClC;CACD;AAED,MAAME,wBAGF;IACF,2EAA2E;IAC3E,CAACC,yBAAc,CAACC,MAAM,CAAC,EAAE;QAAC;QAAQ;KAAS;IAC3C,CAACD,yBAAc,CAACE,MAAM,CAAC,EAAE;QAAC;QAAW;QAAU;KAAO;IACtD,CAACF,yBAAc,CAACG,UAAU,CAAC,EAAEN;IAC7B,iDAAiD;IACjD,cAAc;QAAC;QAAU;KAAO;AAClC;AAEO,SAASC,aACdM,YAAgC,EAChCC,SAAkB;IAElB,IAAID,iBAAiBJ,yBAAc,CAACG,UAAU,EAAE;QAC9C,OAAON;IACT,OAAO,IAAIO,iBAAiBJ,yBAAc,CAACE,MAAM,EAAE;QACjD,OAAOH,qBAAqB,CAACC,yBAAc,CAACE,MAAM,CAAC;IACrD;IAEA,gFAAgF;IAChF,OAAOG,YACHN,qBAAqB,CAAC,aAAa,GACnCA,qBAAqB,CAACC,yBAAc,CAACC,MAAM,CAAC;AAClD"}