{"version":3,"sources":["../../../src/server/lib/incremental-cache-server.ts"],"sourcesContent":["import { createIpcServer } from './server-ipc'\nimport { IncrementalCache } from './incremental-cache'\n\nlet initializeResult:\n  | undefined\n  | {\n      ipcPort: number\n      ipcValidationKey: string\n    }\n\nexport async function initialize(\n  ...constructorArgs: ConstructorParameters<typeof IncrementalCache>\n): Promise<NonNullable<typeof initializeResult>> {\n  const incrementalCache = new IncrementalCache(...constructorArgs)\n\n  const { ipcPort, ipcValidationKey } = await createIpcServer({\n    async revalidateTag(\n      ...args: Parameters<IncrementalCache['revalidateTag']>\n    ) {\n      return incrementalCache.revalidateTag(...args)\n    },\n\n    async get(...args: Parameters<IncrementalCache['get']>) {\n      return incrementalCache.get(...args)\n    },\n\n    async set(...args: Parameters<IncrementalCache['set']>) {\n      return incrementalCache.set(...args)\n    },\n\n    async lock(...args: Parameters<IncrementalCache['lock']>) {\n      return incrementalCache.lock(...args)\n    },\n\n    async unlock(...args: Parameters<IncrementalCache['unlock']>) {\n      return incrementalCache.unlock(...args)\n    },\n  } as any)\n\n  return {\n    ipcPort,\n    ipcValidationKey,\n  }\n}\n"],"names":["createIpcServer","IncrementalCache","initializeResult","initialize","constructorArgs","incrementalCache","ipcPort","ipcValidationKey","revalidateTag","args","get","set","lock","unlock"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":"AAAA,SAASA,eAAe,QAAQ,eAAc;AAC9C,SAASC,gBAAgB,QAAQ,sBAAqB;AAEtD,IAAIC;AAOJ,OAAO,eAAeC,WACpB,GAAGC,eAA+D;IAElE,MAAMC,mBAAmB,IAAIJ,oBAAoBG;IAEjD,MAAM,EAAEE,OAAO,EAAEC,gBAAgB,EAAE,GAAG,MAAMP,gBAAgB;QAC1D,MAAMQ,eACJ,GAAGC,IAAmD;YAEtD,OAAOJ,iBAAiBG,aAAa,IAAIC;QAC3C;QAEA,MAAMC,KAAI,GAAGD,IAAyC;YACpD,OAAOJ,iBAAiBK,GAAG,IAAID;QACjC;QAEA,MAAME,KAAI,GAAGF,IAAyC;YACpD,OAAOJ,iBAAiBM,GAAG,IAAIF;QACjC;QAEA,MAAMG,MAAK,GAAGH,IAA0C;YACtD,OAAOJ,iBAAiBO,IAAI,IAAIH;QAClC;QAEA,MAAMI,QAAO,GAAGJ,IAA4C;YAC1D,OAAOJ,iBAAiBQ,MAAM,IAAIJ;QACpC;IACF;IAEA,OAAO;QACLH;QACAC;IACF;AACF"}