{"version":3,"sources":["../../../../../../src/client/components/react-dev-overlay/internal/helpers/parseStack.ts"],"sourcesContent":["import { parse } from 'next/dist/compiled/stacktrace-parser'\nimport type { StackFrame } from 'next/dist/compiled/stacktrace-parser'\nimport {\n  getHydrationErrorStackInfo,\n  isReactHydrationErrorStack,\n} from '../../../is-hydration-error'\n\nconst regexNextStatic = /\\/_next(\\/static\\/.+)/\n\nexport function parseStack(stack: string): StackFrame[] {\n  const messageAndStack = stack.replace(/^Error: /, '')\n  if (isReactHydrationErrorStack(messageAndStack)) {\n    const { stack: parsedStack } = getHydrationErrorStackInfo(messageAndStack)\n    if (parsedStack) {\n      stack = parsedStack\n    }\n  }\n\n  const frames = parse(stack)\n  return frames.map((frame) => {\n    try {\n      const url = new URL(frame.file!)\n      const res = regexNextStatic.exec(url.pathname)\n      if (res) {\n        const distDir = process.env.__NEXT_DIST_DIR\n          ?.replace(/\\\\/g, '/')\n          ?.replace(/\\/$/, '')\n        if (distDir) {\n          frame.file = 'file://' + distDir.concat(res.pop()!) + url.search\n        }\n      }\n    } catch {}\n    return frame\n  })\n}\n"],"names":["parse","getHydrationErrorStackInfo","isReactHydrationErrorStack","regexNextStatic","parseStack","stack","messageAndStack","replace","parsedStack","frames","map","frame","url","URL","file","res","exec","pathname","process","distDir","env","__NEXT_DIST_DIR","concat","pop","search"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":"AAAA,SAASA,KAAK,QAAQ,uCAAsC;AAE5D,SACEC,0BAA0B,EAC1BC,0BAA0B,QACrB,8BAA6B;AAEpC,MAAMC,kBAAkB;AAExB,OAAO,SAASC,WAAWC,KAAa;IACtC,MAAMC,kBAAkBD,MAAME,OAAO,CAAC,YAAY;IAClD,IAAIL,2BAA2BI,kBAAkB;QAC/C,MAAM,EAAED,OAAOG,WAAW,EAAE,GAAGP,2BAA2BK;QAC1D,IAAIE,aAAa;YACfH,QAAQG;QACV;IACF;IAEA,MAAMC,SAAST,MAAMK;IACrB,OAAOI,OAAOC,GAAG,CAAC,CAACC;QACjB,IAAI;YACF,MAAMC,MAAM,IAAIC,IAAIF,MAAMG,IAAI;YAC9B,MAAMC,MAAMZ,gBAAgBa,IAAI,CAACJ,IAAIK,QAAQ;YAC7C,IAAIF,KAAK;oBACSG,sCAAAA;gBAAhB,MAAMC,WAAUD,+BAAAA,QAAQE,GAAG,CAACC,eAAe,sBAA3BH,uCAAAA,6BACZX,OAAO,CAAC,OAAO,yBADHW,qCAEZX,OAAO,CAAC,OAAO;gBACnB,IAAIY,SAAS;oBACXR,MAAMG,IAAI,GAAG,YAAYK,QAAQG,MAAM,CAACP,IAAIQ,GAAG,MAAOX,IAAIY,MAAM;gBAClE;YACF;QACF,EAAE,UAAM,CAAC;QACT,OAAOb;IACT;AACF"}